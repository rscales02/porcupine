
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>porcupine.textwidget &#8212; Porcupine API 0.70.0-git-91b3c90 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for porcupine.textwidget</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">import</span> <span class="nn">tkinter.font</span> <span class="k">as</span> <span class="nn">tkfont</span>

<span class="kn">import</span> <span class="nn">pygments.styles</span>

<span class="kn">from</span> <span class="nn">porcupine</span> <span class="k">import</span> <span class="n">settings</span><span class="p">,</span> <span class="n">utils</span>


<div class="viewcode-block" id="HandyText"><a class="viewcode-back" href="../../textwidget.html#porcupine.textwidget.HandyText">[docs]</a><span class="k">class</span> <span class="nc">HandyText</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Like ``tkinter.Text``, but with some handy features.</span>

<span class="sd">    All arguments are passed to ``tkinter.Text``.</span>

<span class="sd">    .. virtualevent:: ContentChanged</span>

<span class="sd">        This event is generated when the text in the widget is modified</span>
<span class="sd">        in any way. Unlike ``&lt;&lt;Modified&gt;&gt;``, this event is simply generated</span>
<span class="sd">        every time the content changes, and there&#39;s no need to unset a flag</span>
<span class="sd">        like ``textwidget.edit_modified(False)`` or anything like that.</span>

<span class="sd">        If you want to know what changed and how, use</span>
<span class="sd">        :func:`porcupine.utils.bind_with_data` and</span>
<span class="sd">        ``event.data_tuple(str, str, int, str)``. The first 2 values of the</span>
<span class="sd">        tuple are indexes in the text widget before the text change occurs, the</span>
<span class="sd">        3rd value is the number of characters that were between the indexes</span>
<span class="sd">        before deleting (including newlines) and the 4th value is the new text</span>
<span class="sd">        as a string. So, if the text widget contains ``&#39;hello world&#39;``, then</span>
<span class="sd">        this...</span>
<span class="sd">        ::</span>

<span class="sd">            # characters 0 to 5 on 1st line are the hello</span>
<span class="sd">            textwidget.replace(&#39;1.0&#39;, &#39;1.5&#39;, &#39;toot&#39;)</span>

<span class="sd">        ...changes the ``&#39;hello&#39;`` to ``&#39;toot&#39;``, generating a</span>
<span class="sd">        ``&lt;&lt;ContentChanged&gt;&gt;`` event with ``data_tuple(str, str, int, str)``</span>
<span class="sd">        like this::</span>

<span class="sd">            (&#39;1.0&#39;, &#39;1.5&#39;, 5, &#39;toot&#39;)</span>

<span class="sd">        Note that is ``len(&#39;hello&#39;)``, not ``len(&#39;toot&#39;)``; it represents the</span>
<span class="sd">        length of the old text.</span>

<span class="sd">        Unlike you might think, the 5 is not redundant here. If the whole</span>
<span class="sd">        ``&#39;toot world&#39;`` is changed to ``&#39;&#39;``...</span>
<span class="sd">        ::</span>

<span class="sd">            (&#39;1.0&#39;, &#39;1.10&#39;, 10, &#39;&#39;)</span>

<span class="sd">        ...then ``&#39;1.10&#39;`` is no longer a valid index in the text widget</span>
<span class="sd">        because it contains 0 characters (and 0 is less than 10). In this case,</span>
<span class="sd">        checking only the ``0`` of ``1.0`` and the ``10`` of ``1.10`` could be</span>
<span class="sd">        used to calculate the 10, but that doesn&#39;t work right when changing a</span>
<span class="sd">        multiple lines.</span>

<span class="sd">    .. virtualevent:: CursorMoved</span>

<span class="sd">        This event is generated every time the user moves the cursor or</span>
<span class="sd">        it&#39;s moved with a method of the text widget. Use</span>
<span class="sd">        ``textwidget.index(&#39;insert&#39;)`` to find the current cursor</span>
<span class="sd">        position.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1">#       /\</span>
        <span class="c1">#      /  \  WARNING: serious tkinter magic coming up</span>
        <span class="c1">#     / !! \          proceed at your own risk</span>
        <span class="c1">#    /______\</span>
        <span class="c1">#</span>
        <span class="c1"># this irc conversation might give you an idea of how this works:</span>
        <span class="c1">#</span>
        <span class="c1">#    &lt;Akuli&gt; __Myst__, why do you want to know how it works?</span>
        <span class="c1">#    &lt;__Myst__&gt; Akuli: cause it seems cool</span>
        <span class="c1">#    &lt;Akuli&gt; there&#39;s 0 reason to docment it in the langserver</span>
        <span class="c1">#    &lt;Akuli&gt; ok i can explain :)</span>
        <span class="c1">#    &lt;Akuli&gt; in tcl, all statements are command calls</span>
        <span class="c1">#    &lt;Akuli&gt; set x lol    ;# set variable x to string lol</span>
        <span class="c1">#    &lt;Akuli&gt; set is a command, x and lol are strings</span>
        <span class="c1">#    &lt;Akuli&gt; adding stuff to widgets is also command calls</span>
        <span class="c1">#    &lt;Akuli&gt; .textwidget insert end hello   ;# add hello to the text</span>
        <span class="c1">#            widget</span>
        <span class="c1">#    &lt;Akuli&gt; my magic renames the textwidget command to</span>
        <span class="c1">#            actual_widget_command, and creates a fake text widget</span>
        <span class="c1">#            command that tkinter calls instead</span>
        <span class="c1">#    &lt;Akuli&gt; then this fake command checks for all possible widget</span>
        <span class="c1">#            commands that can move the cursor or change the content</span>
        <span class="c1">#    &lt;Akuli&gt; making sense?</span>
        <span class="c1">#    &lt;__Myst__&gt; ooh</span>
        <span class="c1">#    &lt;__Myst__&gt; so it&#39;s like you&#39;re proxying actual calls to the text</span>
        <span class="c1">#               widget and calculating change events based on that?</span>
        <span class="c1">#    &lt;Akuli&gt; yes</span>
        <span class="c1">#    &lt;__Myst__&gt; very cool</span>

        <span class="c1"># cursor_cb is called whenever the cursor position may have changed,</span>
        <span class="c1"># and change_cb is called whenever the content of the text widget may</span>
        <span class="c1"># have changed</span>
        <span class="n">change_cb_command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_change_cb</span><span class="p">)</span>
        <span class="n">cursor_cb_command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cursor_cb</span><span class="p">)</span>

        <span class="c1"># all widget stuff is implemented in python and in tcl as calls to a</span>
        <span class="c1"># tcl command named str(self), and replacing that with a custom command</span>
        <span class="c1"># is a very powerful way to do magic; for example, moving the cursor</span>
        <span class="c1"># with arrow keys calls the &#39;mark set&#39; widget command :D</span>
        <span class="n">actual_widget_command</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_actual_widget&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s1">&#39;rename&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">actual_widget_command</span><span class="p">)</span>

        <span class="c1"># this part is tcl because i couldn&#39;t get a python callback to work</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        proc </span><span class="si">%(fake_widget)s</span><span class="s1"> </span><span class="si">{args}</span><span class="s1"> {</span>
<span class="s1">            #puts $args</span>

<span class="s1">            # subcommand is e.g. insert, delete, replace, index, search, ...</span>
<span class="s1">            # see text(3tk) for all possible subcommands</span>
<span class="s1">            set subcommand [lindex $args 0]</span>

<span class="s1">            # issue #5: don&#39;t let the cursor to go to the very top or bottom of</span>
<span class="s1">            # the view</span>
<span class="s1">            if {$subcommand == &quot;see&quot;} {</span>
<span class="s1">                # cleaned_index is always a &quot;LINE.COLUMN&quot; string</span>
<span class="s1">                set cleaned_index [</span><span class="si">%(actual_widget)s</span><span class="s1"> index [lindex $args 1]]</span>

<span class="s1">                # from text(3tk): &quot;If index is far out of view, then the</span>
<span class="s1">                # command centers index in the window.&quot; and we want to center</span>
<span class="s1">                # it correctly, so first go to the center, then a few</span>
<span class="s1">                # characters around it, and finally back to center because it</span>
<span class="s1">                # feels less error-prone that way</span>
<span class="s1">                </span><span class="si">%(actual_widget)s</span><span class="s1"> see $cleaned_index</span>
<span class="s1">                </span><span class="si">%(actual_widget)s</span><span class="s1"> see &quot;$cleaned_index - 4 lines&quot;</span>
<span class="s1">                </span><span class="si">%(actual_widget)s</span><span class="s1"> see &quot;$cleaned_index + 4 lines&quot;</span>
<span class="s1">                </span><span class="si">%(actual_widget)s</span><span class="s1"> see $cleaned_index</span>
<span class="s1">                return</span>
<span class="s1">            }</span>

<span class="s1">            set cursor_may_have_moved 0</span>

<span class="s1">            # only these subcommands can change the text, but they can also</span>
<span class="s1">            # move the cursor by changing the text before the cursor</span>
<span class="s1">            if {$subcommand == &quot;delete&quot; ||</span>
<span class="s1">                    $subcommand == &quot;insert&quot; ||</span>
<span class="s1">                    $subcommand == &quot;replace&quot;} {</span>
<span class="s1">                set cursor_may_have_moved 1</span>

<span class="s1">                # this is like self._change_cb(*args) in python</span>
<span class="s1">                </span><span class="si">%(change_cb)s</span><span class="s1"> {*}$args</span>
<span class="s1">            }</span>

<span class="s1">            # it&#39;s important that this comes after the change cb stuff because</span>
<span class="s1">            # this way it&#39;s possible to get old_length in self._change_cb()...</span>
<span class="s1">            # however, it&#39;s also important that this is before the mark set</span>
<span class="s1">            # stuff because the documented way to access the new index in a</span>
<span class="s1">            # &lt;&lt;CursorMoved&gt;&gt; binding is getting it directly from the widget</span>
<span class="s1">            set result [</span><span class="si">%(actual_widget)s</span><span class="s1"> {*}$args]</span>

<span class="s1">            # only[*] &#39;textwidget mark set insert new_location&#39; can change the</span>
<span class="s1">            # cursor position, because the cursor position is implemented as a</span>
<span class="s1">            # mark named &quot;insert&quot; and there are no other commands that move</span>
<span class="s1">            # marks</span>
<span class="s1">            #</span>
<span class="s1">            # [*] i lied, hehe &gt;:D MUHAHAHA ... inserting text before the</span>
<span class="s1">            # cursor also changes it</span>
<span class="s1">            if {$subcommand == &quot;mark&quot; &amp;&amp;</span>
<span class="s1">                    [lindex $args 1] == &quot;set&quot; &amp;&amp;</span>
<span class="s1">                    [lindex $args 2] == &quot;insert&quot;} {</span>
<span class="s1">                set cursor_may_have_moved 1</span>
<span class="s1">            }</span>

<span class="s1">            if {$cursor_may_have_moved} {</span>
<span class="s1">                </span><span class="si">%(cursor_cb)s</span><span class="s1"></span>
<span class="s1">            }</span>

<span class="s1">            return $result</span>
<span class="s1">        }</span>
<span class="s1">        &#39;&#39;&#39;</span> <span class="o">%</span> <span class="p">{</span>
            <span class="s1">&#39;fake_widget&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="s1">&#39;actual_widget&#39;</span><span class="p">:</span> <span class="n">actual_widget_command</span><span class="p">,</span>
            <span class="s1">&#39;change_cb&#39;</span><span class="p">:</span> <span class="n">change_cb_command</span><span class="p">,</span>
            <span class="s1">&#39;cursor_cb&#39;</span><span class="p">:</span> <span class="n">cursor_cb_command</span><span class="p">,</span>
        <span class="p">})</span>

        <span class="c1"># see _cursor_cb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_old_cursor_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_change_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcommand</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="c1"># contains (start, end, old_length, new_text) tuples</span>
        <span class="n">changes</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># search for &#39;pathName delete&#39; in text(3tk)... it&#39;s a wall of text,</span>
        <span class="c1"># and this thing has to implement every detail of that wall</span>
        <span class="k">if</span> <span class="n">subcommand</span> <span class="o">==</span> <span class="s1">&#39;delete&#39;</span><span class="p">:</span>
            <span class="c1"># &quot;All indices are first checked for validity before any deletions</span>
            <span class="c1"># are made.&quot; they are already validated, but this doesn&#39;t hurt</span>
            <span class="c1"># imo... but note that rest of this code assumes that this is done!</span>
            <span class="c1"># not everything works in corner cases without this</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>

            <span class="c1"># tk has a funny abstraction of an invisible newline character at</span>
            <span class="c1"># the end of file, it&#39;s always there but nothing else uses it, so</span>
            <span class="c1"># let&#39;s ignore it</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">old_arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">old_arg</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">):</span>
                    <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;end - 1 char&#39;</span><span class="p">)</span>

            <span class="c1"># &quot;If index2 is not specified then the single character at index1</span>
            <span class="c1"># is deleted.&quot; and later: &quot;If more indices are given, multiple</span>
            <span class="c1"># ranges of text will be deleted.&quot; but no mention about combining</span>
            <span class="c1"># these features, this works like the text widget actually behaves</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> + 1 char&#39;</span> <span class="o">%</span> <span class="n">args</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="n">pairs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>   <span class="c1"># an iterator, not a list yet</span>

            <span class="c1"># &quot;If index2 does not specify a position later in the text than</span>
            <span class="c1"># index1 then no characters are deleted.&quot;</span>
            <span class="c1"># note that this also converts pairs to a list</span>
            <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pairs</span>
                     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="n">end</span><span class="p">)]</span>

            <span class="c1"># &quot;They [index pairs, aka ranges] are sorted [...].&quot;</span>
            <span class="k">def</span> <span class="nf">sort_by_range_beginnings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pair</span><span class="p">):</span>
                <span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="n">_</span><span class="p">),</span> <span class="p">(</span><span class="n">start2</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">pair</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="n">start2</span><span class="p">):</span>
                    <span class="k">return</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="n">start2</span><span class="p">):</span>
                    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">return</span> <span class="mi">0</span>

            <span class="n">pairs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">cmp_to_key</span><span class="p">(</span><span class="n">sort_by_range_beginnings</span><span class="p">))</span>

            <span class="c1"># &quot;If multiple ranges with the same start index are given, then the</span>
            <span class="c1"># longest range is used. If overlapping ranges are given, then they</span>
            <span class="c1"># will be merged into spans that do not cause deletion of text</span>
            <span class="c1"># outside the given ranges due to text shifted during deletion.&quot;</span>
            <span class="k">def</span> <span class="nf">merge_index_ranges</span><span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="n">end1</span><span class="p">,</span> <span class="n">start2</span><span class="p">,</span> <span class="n">end2</span><span class="p">):</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">start1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="n">start2</span><span class="p">)</span> <span class="k">else</span> <span class="n">start2</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">end1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">end1</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="n">end2</span><span class="p">)</span> <span class="k">else</span> <span class="n">end2</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

            <span class="c1"># loop through pairs of pairs</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="n">end1</span><span class="p">),</span> <span class="p">(</span><span class="n">start2</span><span class="p">,</span> <span class="n">end2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pairs</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">end1</span><span class="p">,</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="n">start2</span><span class="p">):</span>
                    <span class="c1"># they overlap</span>
                    <span class="n">new_pair</span> <span class="o">=</span> <span class="n">merge_index_ranges</span><span class="p">(</span><span class="n">start1</span><span class="p">,</span> <span class="n">end1</span><span class="p">,</span> <span class="n">start2</span><span class="p">,</span> <span class="n">start2</span><span class="p">)</span>
                    <span class="n">pairs</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_pair</span><span class="p">]</span>

            <span class="c1"># &quot;[...] and the text is removed from the last range to the first</span>
            <span class="c1"># range so deleted text does not cause an undesired index shifting</span>
            <span class="c1"># side-effects.&quot;</span>
            <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">pairs</span><span class="p">):</span>
                <span class="n">changes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)),</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>

        <span class="c1"># the man page&#39;s inserting section is also kind of a wall of</span>
        <span class="c1"># text, but not as bad as the delete</span>
        <span class="k">elif</span> <span class="n">subcommand</span> <span class="o">==</span> <span class="s1">&#39;insert&#39;</span><span class="p">:</span>
            <span class="n">index</span><span class="p">,</span> <span class="o">*</span><span class="n">other_args</span> <span class="o">=</span> <span class="n">args</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="c1"># &quot;If index refers to the end of the text (the character after the</span>
            <span class="c1"># last newline) then the new text is inserted just before the last</span>
            <span class="c1"># newline instead.&quot;</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">):</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;end - 1 char&#39;</span><span class="p">)</span>

            <span class="c1"># we don&#39;t care about the tagList arguments to insert, but we need</span>
            <span class="c1"># to handle the other arguments nicely anyway: &quot;If multiple</span>
            <span class="c1"># chars-tagList argument pairs are present, they produce the same</span>
            <span class="c1"># effect as if a separate pathName insert widget command had been</span>
            <span class="c1"># issued for each pair, in order. The last tagList argument may be</span>
            <span class="c1"># omitted.&quot; i&#39;m not sure what &quot;in order&quot; means here, but i tried</span>
            <span class="c1"># it, and &#39;textwidget.insert(&#39;1.0&#39;, &#39;asd&#39;, [], &#39;toot&#39;, [])&#39; inserts</span>
            <span class="c1"># &#39;asdtoot&#39;, not &#39;tootasd&#39;</span>
            <span class="n">inserted_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">other_args</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">changes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inserted_text</span><span class="p">))</span>

        <span class="c1"># an even smaller wall of text that mostly refers to insert and replace</span>
        <span class="k">elif</span> <span class="n">subcommand</span> <span class="o">==</span> <span class="s1">&#39;replace&#39;</span><span class="p">:</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="o">*</span><span class="n">other_args</span> <span class="o">=</span> <span class="n">args</span>
            <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
            <span class="n">inserted_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">other_args</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>

            <span class="c1"># didn&#39;t find in docs, but tcl throws an error for this</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

            <span class="n">changes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)),</span>
                            <span class="n">inserted_text</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;the tcl code called _change_cb with unexpected subcommand: &quot;</span> <span class="o">+</span>
                <span class="n">subcommand</span><span class="p">)</span>

        <span class="c1"># some plugins expect &lt;&lt;ContentChanged&gt;&gt; events to occur after changing</span>
        <span class="c1"># the content in the editor, but the tcl code in __init__ needs them to</span>
        <span class="c1"># run before, so here is the solution</span>
        <span class="nd">@self</span><span class="o">.</span><span class="n">after_idle</span>       <span class="c1"># yes, this works</span>
        <span class="k">def</span> <span class="nf">this_runs_after_changes</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">changes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;ContentChanged&gt;&gt;&#39;</span><span class="p">,</span>
                                    <span class="n">data</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">create_tcl_list</span><span class="p">(</span><span class="n">change</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_cursor_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># more implicit newline stuff</span>
        <span class="n">new_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_pos</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">):</span>
            <span class="n">new_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;end - 1 char&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_pos</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_old_cursor_pos</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_old_cursor_pos</span> <span class="o">=</span> <span class="n">new_pos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;CursorMoved&gt;&gt;&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="HandyText.iter_chunks"><a class="viewcode-back" href="../../textwidget.html#porcupine.textwidget.HandyText.iter_chunks">[docs]</a>    <span class="k">def</span> <span class="nf">iter_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Iterate over the content as chunks of *n* lines.</span>

<span class="sd">        Each yielded line ends with a ``\n`` character. Lines are not</span>
<span class="sd">        broken down the middle, and ``&#39;&#39;`` is never yielded.</span>

<span class="sd">        Note that the last chunk is less than *n* lines long unless the</span>
<span class="sd">        total number of lines is divisible by *n*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c1"># this is not a mistake, line numbers start at 1</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">n</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.0&#39;</span> <span class="o">%</span> <span class="n">end</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">):</span>
                <span class="c1"># &#39;%d.0&#39; % start can be &#39;end - 1 char&#39; in a corner</span>
                <span class="c1"># case, let&#39;s not yield an empty string</span>
                <span class="n">last_chunk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.0&#39;</span> <span class="o">%</span> <span class="n">start</span><span class="p">,</span> <span class="s1">&#39;end - 1 char&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">last_chunk</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">last_chunk</span>
                <span class="k">break</span>

            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.0&#39;</span> <span class="o">%</span> <span class="n">start</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.0&#39;</span> <span class="o">%</span> <span class="n">end</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">end</span></div>

<div class="viewcode-block" id="HandyText.iter_lines"><a class="viewcode-back" href="../../textwidget.html#porcupine.textwidget.HandyText.iter_lines">[docs]</a>    <span class="k">def</span> <span class="nf">iter_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Iterate over the content as lines.</span>

<span class="sd">        The trailing ``\n`` characters of each line are included.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_chunks</span><span class="p">():</span>
            <span class="k">yield from</span> <span class="n">chunk</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="n">keepends</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div></div>


<span class="c1"># this can be used for implementing other themed things too, e.g. the</span>
<span class="c1"># line number plugin</span>
<div class="viewcode-block" id="ThemedText"><a class="viewcode-back" href="../../textwidget.html#porcupine.textwidget.ThemedText">[docs]</a><span class="k">class</span> <span class="nc">ThemedText</span><span class="p">(</span><span class="n">HandyText</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A :class:`.HandyText` subclass that uses the Pygments style&#39;s colors.</span>

<span class="sd">    You can use this class just like :class:`.HandyText`, it takes care</span>
<span class="sd">    of switching the colors by itself. This is useful for things like</span>
<span class="sd">    :source:`porcupine/plugins/linenumbers.py`.</span>

<span class="sd">    .. seealso::</span>
<span class="sd">        Syntax highlighting is implemented with Pygments in</span>
<span class="sd">        :source:`porcupine/plugins/highlight.py`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="s1">&#39;General&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="s1">&#39;pygments_style&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_style</span><span class="p">,</span> <span class="n">run_now</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">on_destroy</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="s1">&#39;General&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span>
                <span class="s1">&#39;pygments_style&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_style</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Destroy&gt;&#39;</span><span class="p">,</span> <span class="n">on_destroy</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">pygments</span><span class="o">.</span><span class="n">styles</span><span class="o">.</span><span class="n">get_style_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">bg</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">background_color</span>

        <span class="c1"># yes, style.default_style can be &#39;#rrggbb&#39;, &#39;&#39; or nonexistent</span>
        <span class="c1"># this is undocumented</span>
        <span class="c1">#</span>
        <span class="c1">#   &gt;&gt;&gt; from pygments.styles import *</span>
        <span class="c1">#   &gt;&gt;&gt; [getattr(get_style_by_name(name), &#39;default_style&#39;, &#39;???&#39;)</span>
        <span class="c1">#   ...  for name in get_all_styles()]</span>
        <span class="c1">#   [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;???&#39;, &#39;???&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;,</span>
        <span class="c1">#    &#39;???&#39;, &#39;???&#39;, &#39;&#39;, &#39;#cccccc&#39;, &#39;&#39;, &#39;&#39;, &#39;???&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;,</span>
        <span class="c1">#    &#39;#222222&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;???&#39;, &#39;&#39;]</span>
        <span class="n">fg</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="s1">&#39;default_style&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">utils</span><span class="o">.</span><span class="n">invert_color</span><span class="p">(</span><span class="n">bg</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;fg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fg</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;bg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bg</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;insertbackground&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fg</span>  <span class="c1"># cursor color</span>

        <span class="c1"># this is actually not too bad :D</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;selectforeground&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bg</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;selectbackground&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fg</span></div>


<div class="viewcode-block" id="MainText"><a class="viewcode-back" href="../../textwidget.html#porcupine.textwidget.MainText">[docs]</a><span class="k">class</span> <span class="nc">MainText</span><span class="p">(</span><span class="n">ThemedText</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Don&#39;t use this. It may be changed later.&quot;&quot;&quot;</span>

    <span class="c1"># the filetype is needed for setting the tab width and indenting</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">filetype</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_filetype</span><span class="p">(</span><span class="n">filetype</span><span class="p">)</span>

        <span class="c1"># FIXME: lots of things have been turned into plugins, but</span>
        <span class="c1"># there&#39;s still wayyyy too much stuff in here...</span>
        <span class="n">partial</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span>     <span class="c1"># pep8 line length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;BackSpace&gt;&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_delete</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Control-BackSpace&gt;&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_delete</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Control-Delete&gt;&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_delete</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Shift-Control-Delete&gt;&#39;</span><span class="p">,</span>
                  <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_delete</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">shifted</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Shift-Control-BackSpace&gt;&#39;</span><span class="p">,</span>
                  <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_delete</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">shifted</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;parenright&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_closing_brace</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;bracketright&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_closing_brace</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;braceright&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_closing_brace</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># most other things work by default, but these don&#39;t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Control-v&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paste</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Control-y&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;Control-a&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select_all</span><span class="p">)</span>

        <span class="n">utils</span><span class="o">.</span><span class="n">bind_mouse_wheel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_ctrl_wheel</span><span class="p">,</span> <span class="n">prefixes</span><span class="o">=</span><span class="s1">&#39;Control-&#39;</span><span class="p">)</span>

    <span class="c1"># TODO: the run plugin contains similar code, maybe reuse it somehow?</span>
    <span class="k">def</span> <span class="nf">_on_ctrl_wheel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="s1">&#39;General&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;reset&#39;</span><span class="p">:</span>
            <span class="n">config</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="s1">&#39;font_size&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">config</span><span class="p">[</span><span class="s1">&#39;font_size&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;up&#39;</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">settings</span><span class="o">.</span><span class="n">InvalidValue</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">set_filetype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filetype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filetype</span> <span class="o">=</span> <span class="n">filetype</span>

        <span class="c1"># from the text(3tk) man page: &quot;To achieve a different standard</span>
        <span class="c1"># spacing, for example every 4 characters, simply configure the</span>
        <span class="c1"># widget with -tabs &quot;[expr {4 * [font measure $font 0]}] left&quot;</span>
        <span class="c1"># -tabstyle wordprocessor.&quot;</span>
        <span class="c1">#</span>
        <span class="c1"># my version is kind of minimal compared to that example, but it</span>
        <span class="c1"># seems to work :)</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">tkfont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;TkFixedFont&#39;</span><span class="p">,</span> <span class="n">exists</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;tabs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">font</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">filetype</span><span class="o">.</span><span class="n">indent_size</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_on_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_down</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">shifted</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This runs when the user presses backspace or delete.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag_ranges</span><span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">):</span>
            <span class="c1"># nothing is selected, we can do non-default stuff</span>
            <span class="k">if</span> <span class="n">control_down</span> <span class="ow">and</span> <span class="n">shifted</span><span class="p">:</span>
                <span class="c1"># plan A: delete until end or beginning of line</span>
                <span class="c1"># plan B: delete a newline character if there&#39;s nothing</span>
                <span class="c1">#         to delete with plan A</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">keysym</span> <span class="o">==</span> <span class="s1">&#39;Delete&#39;</span><span class="p">:</span>
                    <span class="n">plan_a</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">,</span> <span class="s1">&#39;insert lineend&#39;</span><span class="p">)</span>
                    <span class="n">plan_b</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">,</span> <span class="s1">&#39;insert + 1 char&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plan_a</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;insert linestart&#39;</span><span class="p">,</span> <span class="s1">&#39;insert&#39;</span><span class="p">)</span>
                    <span class="n">plan_b</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;insert - 1 char&#39;</span><span class="p">,</span> <span class="s1">&#39;insert&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">plan_a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">plan_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="c1"># nothing can be deleted with plan a</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="n">plan_b</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="n">plan_a</span><span class="p">)</span>
                <span class="k">return</span> <span class="s1">&#39;break&#39;</span>

            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">keysym</span> <span class="o">==</span> <span class="s1">&#39;BackSpace&#39;</span><span class="p">:</span>
                <span class="n">lineno</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">before_cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.0&#39;</span> <span class="o">%</span> <span class="n">lineno</span><span class="p">,</span> <span class="s1">&#39;insert&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">before_cursor</span> <span class="ow">and</span> <span class="n">before_cursor</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="s1">&#39;break&#39;</span>

                <span class="k">if</span> <span class="n">control_down</span><span class="p">:</span>
                    <span class="c1"># delete previous word</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;PrevWord&gt;&gt;&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
                    <span class="k">return</span> <span class="s1">&#39;break&#39;</span>

            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">keysym</span> <span class="o">==</span> <span class="s1">&#39;Delete&#39;</span> <span class="ow">and</span> <span class="n">control_down</span><span class="p">:</span>
                <span class="c1"># delete next word</span>
                <span class="n">old_cursor_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;NextWord&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">old_cursor_pos</span><span class="p">,</span> <span class="s1">&#39;insert&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_on_closing_brace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedent automatically.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">indent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert indentation character(s) at the given location.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype</span><span class="o">.</span><span class="n">tabs2spaces</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># we can&#39;t just add &#39; &#39;*self._filetype.indent_size, for example,</span>
        <span class="c1"># if indent_size is 4 and there are 7 charaters we add 1 space</span>
        <span class="n">spaces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype</span><span class="o">.</span><span class="n">indent_size</span>    <span class="c1"># pep-8 line length</span>
        <span class="n">how_many_chars</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">location</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">spaces2add</span> <span class="o">=</span> <span class="n">spaces</span> <span class="o">-</span> <span class="p">(</span><span class="n">how_many_chars</span> <span class="o">%</span> <span class="n">spaces</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">spaces2add</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dedent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove indentation character(s) if possible.</span>

<span class="sd">        This method tries to remove spaces intelligently so that</span>
<span class="sd">        everything&#39;s lined up evenly based on the indentation settings.</span>
<span class="sd">        This method is useful for dedenting whole lines (with location</span>
<span class="sd">        set to beginning of the line) or deleting whitespace in the</span>
<span class="sd">        middle of a line.</span>

<span class="sd">        This returns True if something was done, and False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype</span><span class="o">.</span><span class="n">tabs2spaces</span><span class="p">:</span>
            <span class="n">one_back</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - 1 char&#39;</span> <span class="o">%</span> <span class="n">location</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">one_back</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">one_back</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">lineno</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">location</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> linestart&#39;</span> <span class="o">%</span> <span class="n">location</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> lineend&#39;</span> <span class="o">%</span> <span class="n">location</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">column</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype</span><span class="o">.</span><span class="n">indent_size</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">column</span> <span class="o">-</span> <span class="p">(</span><span class="n">column</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype</span><span class="o">.</span><span class="n">indent_size</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">column</span><span class="p">:</span>    <span class="c1"># prefer deleting from left side</span>
                <span class="n">start</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype</span><span class="o">.</span><span class="n">indent_size</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype</span><span class="o">.</span><span class="n">indent_size</span>

        <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>    <span class="c1"># don&#39;t go past end of line</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># delete undersized indents</span>
            <span class="n">whitespaces</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
            <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">whitespaces</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>   <span class="c1"># &#39;&#39;.isspace() is False</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lineno</span><span class="p">,</span> <span class="n">start</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lineno</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_redo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;Redo&gt;&gt;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;break&#39;</span>

    <span class="k">def</span> <span class="nf">_paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;Paste&gt;&gt;&#39;</span><span class="p">)</span>

        <span class="c1"># by default, selected text doesn&#39;t go away when pasting</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sel_start</span><span class="p">,</span> <span class="n">sel_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag_ranges</span><span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="c1"># nothing selected</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">sel_start</span><span class="p">,</span> <span class="n">sel_end</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;break&#39;</span>

    <span class="k">def</span> <span class="nf">_select_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag_add</span><span class="p">(</span><span class="s1">&#39;sel&#39;</span><span class="p">,</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;end - 1 char&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;break&#39;</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Porcupine API</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../plugin-intro.html">Introduction to Writing Plugins</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../porcupine.html"><code class="docutils literal notranslate"><span class="pre">porcupine</span></code>  The top level Porcupine package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../actions.html"><code class="docutils literal notranslate"><span class="pre">porcupine.actions</span></code>  Add stuff to the menubar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tabs.html"><code class="docutils literal notranslate"><span class="pre">porcupine.tabs</span></code>  The tab manager and tabs in it</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../textwidget.html"><code class="docutils literal notranslate"><span class="pre">porcupine.textwidget</span></code>  Handy <code class="docutils literal notranslate"><span class="pre">tkinter.Text</span></code> subclasses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../images.html"><code class="docutils literal notranslate"><span class="pre">porcupine.images</span></code>  Load images that come with Porcupine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dirs.html"><code class="docutils literal notranslate"><span class="pre">porcupine.dirs</span></code>  Paths to Porcupines files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filetypes.html">File Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../settings.html"><code class="docutils literal notranslate"><span class="pre">porcupine.settings</span></code>  Porcupines setting manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pluginloader.html"><code class="docutils literal notranslate"><span class="pre">porcupine.pluginloader</span></code>  The module that loads plugins on startup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utils.html"><code class="docutils literal notranslate"><span class="pre">porcupine.utils</span></code>  Handy utility functions and classes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Akuli.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>